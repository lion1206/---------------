import random  
import binascii  
  
# Определяем алфавит  
alph = "абвгдежзийклмнопрстуфхцчшщъыьэюя"  
  
def clearCrypte(text):  
    """  
    Предобработка текста для шифрования:  
    - Приводит текст к нижнему регистру.  
    - Заменяет точки и запятые на 'тчк' и 'зпт'.  
    - Заменяет 'ё' на 'е'.  
    - Заменяет пробелы на 'прб' если длина текста больше 500 символов, иначе удаляет пробелы.  
    """  
    text = text.lower()  
    text = text.replace('.', 'тчк')  
    text = text.replace(',', 'зпт')  
    text = text.replace('ё', 'е')  
    if len(text) > 500:  
        text = text.replace(' ', 'прб')  
    else:  
        text = text.replace(' ', '')  
    return text  
  
def hex_to_str(hex_string):  
    """  
    Преобразует шестнадцатеричное представление строки в обычную строку.  
    """  
    byte_array = bytes.fromhex(hex_string)  
    return byte_array.decode('utf-8')  
  
def clearEncypte(text):  
    """  
    Обратная предобработка текста после расшифрования:  
    - Восстанавливает пробелы, точки и запятые.  
    """  
    if len(text) > 500:  
        text = text.replace('прб', ' ')  
    text = text.replace('тчк', '.')  
    text = text.replace('зпт', ',')  
    return text  
  
def decryption_format(text):  
    """  
    Форматирование текста после расшифрования.  
    """  
    # Пример: удаление лишних символов или форматирование текста  
    return text.strip()  
  
def listalf():  
    """  
    Возвращает список символов алфавита.  
    """  
    return list(alph)  
  
  
# Константы и вспомогательные функции для Магмы  
pi = [[12, 4, 6, 2, 10, 5, 11, 9, 14, 8, 13, 7, 0, 3, 15, 1], [6, 8, 2, 3, 9, 10, 5, 12, 1, 14, 4, 7, 11, 13, 0, 15], [11, 3, 5, 8, 2, 15, 10, 13, 14, 1, 7, 4, 12, 9, 6, 0], [12, 8, 2, 1, 13, 4, 15, 6, 7, 0, 10, 5, 3, 14, 9, 11], [7, 15, 5, 10, 8, 1, 6, 13, 0, 9, 3, 14, 11, 4, 2, 12], [5, 13, 15, 6, 9, 2, 12, 10, 11, 7, 8, 1, 4, 3, 14, 0], [8, 14, 2, 5, 6, 9, 1, 12, 15, 4, 11, 0, 13, 10, 3, 7], [1, 7, 14, 13, 0, 5, 8, 3, 4, 15, 10, 6, 9, 12, 11, 2]]  
MASK32 = 2 ** 32 - 1  
  
def t(x):  
    y = 0  
    for i in reversed(range(8)):  
        j = (x >> 4 * i) & 0xf  
        y <<= 4  
        y ^= pi[i][j]  
    return y  
  
def rot11(x):  
    return ((x << 11) ^ (x >> (32 - 11))) & MASK32  
  
def g(x, k):  
    return rot11(t((x + k) % 2 ** 32))  
  
def split(x):  
    L = x >> 32  
    R = x & MASK32  
    return (L, R)  
  
def join_parts(left_part, right_part):  
    return (left_part << 32) ^ right_part  
  
def magma_key_schedule(k):  
    keys = []  
    for i in reversed(range(8)):  
        keys.append((k >> (32 * i)) & MASK32)  
    for i in range(8):  
        keys.append(keys[i])  
    for i in range(8):  
        keys.append(keys[i])  
    for i in reversed(range(8)):  
        keys.append(keys[i])  
    return keys  
  
def magma_encrypt(x, k):  
    keys = magma_key_schedule(k)  
    (L, R) = split(x)  
    for i in range(31):  
        (L, R) = (R, L ^ g(R, keys[i]))  
    return format(join_parts(L ^ g(R, keys[-1]), R), '08X')  
  
def magma_decrypt(x, k, mode):  
    res = ''  
    L, R = int(x[0]) >> 32, int(x[0]) & MASK32  
    for j in range(31):  
        (L, R) = (R, L ^ g(R, k[j]))  
    if mode == 1:  
        result = format(join_parts(L ^ g(R, k[-1]), R), 'x')  
        res += hex_to_str(result)  
    elif mode == 2:  
        return format(join_parts(L ^ g(R, k[-1]), R), "0x")  
    return res  
  
while True:
    secet = int(input("Введите режим работы(1 - Шифрование, 2 - Расшифровка, 3 - выход из программы): "))  
    if secet == 1:  
        shifr = ""  
        text = str(input("Введите текст: "))  
        text = clearCrypte(text)  
        key = int('ffeeddccbbaa99887766554433221100f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff', 16)  
        mode = int(input("Введите режим работы(1 - текст, 2 - ГОСТ): "))  
        if len(text) % 4 != 0:  
            for i in range(4 - len(text) % 4):  
                text += str(alph[random.randint(0, 31)])  
        if mode == 1:  
            while len(text) > 0:
                text_16 = int(text[:4].encode('utf-8').hex(), 16)  
                text = text[4:]  
                shifr += magma_encrypt(text_16, key) + " "  
            print(shifr) 
        elif mode == 2:  
            text = int(text, 16)  
            print(magma_encrypt(text, key))  
    elif secet == 2:  
        res = ""  
        text = str(input("Введите текст: "))  
       
        mode = int(input("Введите режим работы(1 - текст , 2 - ГОСТ): "))  
        key = magma_key_schedule(int('ffeeddccbbaa99887766554433221100f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff', 16))  
        key.reverse()  
        text = text.split()  
        text = [int(h, 16) for h in text]  
        for i in range(len(text)):  
            dec_text = [text[i]]  
            res += magma_decrypt(dec_text, key, mode)  
        print(clearEncypte(res))  
    if secet == 3:
        break
  


# text - fedcba9876543210
# key - ffeeddccbbaa99887766554433221100f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff
# untext - 4ee901e5c2d8ca3d

#11C169D233662968 8121639DE201B34B E8ABCE10CADA29F4 C0AF0B3B47C8107 8C885943C189A81C 3F9665E171AE1336 21770648DAFC60DB 38246F3B6236E4F1 A992A5677A23C201 5ADF241BF829BB2F E8518BEBA9740BE0 E2C267FDF393A96D E315327C6D461C7 24E775537E627102 8809765114C566E8 A59985A622B464A8 B2EB0D73DAD9A828 364988373067F9E 1EB57BE1F67D7FCD 60F900E1775A8335 33852C5C928152D3 140FD373EDF4519A 7660660DD492A92C 4C6A3D6ABAED1F40 C2AD7FD3A092DB55 1B316324AC4E9988 7516F3FC1C158C18 999F6422CCF188DC A18225C68CD154A1 921C3291D65F8B2E 4030FDD70CCF2153 1232171644AEE2D7 DF1B6B7A6BCC8EF0 CAB0B29CD75A9463 5936999F299B8A87 6856A9F489B8587F 7E6CA88DC2C27352 A59985A622B464A8 697C51377E5588DA D7155F9D05744076 1C53E5FF8D623A42 E37F4210F10F65E7 78D2EF0F79DD4EAC 2C52EC5B505F306A 69DB320D91A76A12 DF1B6B7A6BCC8EF0 1A51077806493163 7C8145AF1423DE7B 958072C5DE54E3D9 8A0A65577AE20A9B 5C8884F20DA7C6B1 1B6035DD4A7AD724 169F30707CE607B7 F8D7B2FA13DE1D67 CA452817DABF9963 1BC9D1CD7A4C3DD8 697C51377E5588DA 90B4171F9DF0A00A F52D1C676C589E 7FAE952CAE436D12 4C6A3D6ABAED1F40 4C6A3D6ABAED1F40 A83640F86493FF18 8CCFBC21D1FABE4E 4C6A3D6ABAED1F40 9716E5CBD9E158CD 373BDEDD328B9715 98129734B12E085B CA865F9779000D4E 9C5107A4E9EE6FD7 2CA19703413D10D0 9CA11DD9BF207A98 4C6A3D6ABAED1F40 8E0928640118DB1D 9716E5CBD9E158CD C2B922CB717E83C5 8121639DE201B34B 191FD32B69EC0036 13F1368186706438 573FC4F0C19AF0BB AC5C1BABD4144F8 288C5C4776913C30 50A974F1731633EE 3CFFDE6F26064FBB 71FDB60FAD76B2E3 1BC9D1CD7A4C3DD8 E8ABCE10CADA29F4 C0AF0B3B47C8107 364988373067F9E 3930DB7A6977A36B 4A9298B3921A39A9 1B07DD0A8D370782 6C7C2F5842AEF37B 88B5DD75D812D699 712D0B3B44894C53 B03F84EC96E956A9 7815629E5888563E 4C6A3D6ABAED1F40 84806CF819F41E47 C6DBA17CD63163D6 7525466BDCB597B9 DC518A3EB0253ACE 5C8884F20DA7C6B1 140FD373EDF4519A 7660660DD492A92C FC3417B7414148DF C1EA8F8219F3324 1232171644AEE2D7 7EEFF4DEC17A44B3 8CCFBC21D1FABE4E 111112B2F100ABFC 44B490E5C77A028C ABD0E266D5B27515 1232171644AEE2D7 3E27DB8ED3D7E940 FC3417B7414148DF 38996A57333B7BF3 5473FF6750DD28EA 9C5107A4E9EE6FD7 1044EC9697F93702 B81CB50073E86C39 2BEB447B073F93E9 1232171644AEE2D7 24BBE5760C629520 128CB7B20B614D5D C42D454F2F0C0B5F 1232171644AEE2D7 C88F79EFE43A1255 FB4C5F15CCA05320 9716E5CBD9E158CD E3DBC38CF9661D24 A5FCE99917A52581 69CAA8E142F1518B 8121639DE201B34B A12A475BE6524C2F D24F04A616BC0A6E DF5114E02AD1E85C 3717CB5BC190DDA5 C3771BD852D3C9F1 D24F04A616BC0A6E 95ADF640ECEEEAD 680F81A33C8BCAEE 3CFFDE6F26064FBB ED62D14B468551EE 3717CB5BC190DDA5 2A1FB06CC0637C2A D3178735F6085BA2 111112B2F100ABFC 3E46A6C2D9C3F693 D5DFC35908E75928 D8C7DBF43A3D0D 5C8884F20DA7C6B1 2BEB447B073F93E9 1232171644AEE2D7 A016C47926AD211A A92741694C799380 8ED9B1A1BBFB799D 4E64713284272CA5 13F1368186706438 29FDB02327C9FC19 950CCD0D3B1DE07D 1EAAD811D5F506B F2E9E58247CD8FFD 5FF018478D190A23 FC3417B7414148DF 4090A6E1182C61B1 145C1DE7065B101D B80A48CDBFE8686 6F554D910C95F8B5 7C4A1B21926B9F81 A59985A622B464A8 A52AF5C189CBCEFC 349AAFAF3EE40825 8CCFBC21D1FABE4E 5936999F299B8A87 880DAE92E6B4CEAB B710CA7BBB5C3D7C F1D36ED6F3F27621 1F591672231C8113 DD771DE70042B25B 50576890C420C606 DB44A17709EDBF8D DF1B6B7A6BCC8EF0 1B0F69FEDA7734BA 86A4A91784D9C613 72728D4742EA1773 142B8E2EC59DD9D7 47F66CAC7A51F63D 2FB017AF2F91A0A5 CFA24E91A3D2162D 8A03F12536393BE1 68CEF71DBDD509BD FCF5287A9B058DE6 BA79A4EF4F32E32C 2BEB447B073F93E9 1232171644AEE2D7 E4D5C64C2ED99699 140FD373EDF4519A CEBD2DFFDAA0B040 145C1DE7065B101D 79476BB3CF9EE8CA 9530231C38779B6 D02329CDDCFFD5F6 53FF071D801E1A60 41ADA098566AB3B6 F0D7E79D94AAD2AC A59985A622B464A8 B2EB0D73DAD9A828 20A75A3117360879 77E6ADAA7EBE4374 C929B187FFD03473 9716E5CBD9E158CD 8B1190926DAF2038 259D12250BC258DA EE83E29EEAAFB803 F16F0BF6375E9B00 A59985A622B464A8 68085DA78A4FDB48 F74A42E2155F38E 93AE24D820F84252 A59985A622B464A8 E4BBF71C1B1B53C8 EAE7E04C2424DF20 8CCFBC21D1FABE4E 1F591672231C8113 68BC7004971C4206 7F2CEBD06564520E 3D76EDF803C85A23 285BB310B78C8198 1232171644AEE2D7 F3D1CD1028BA9302 9C5107A4E9EE6FD7 C5E3B60941594898 5CE112C1656BCD88 4C6A3D6ABAED1F40 A52F1C54F1FE4C02 10B9E78CAFA65899 9B7C44DEA06BC0FF 672D3533F8C340E7 37E78041F04825E9 B101D34BCBEDAAB3 7E0E93F5C7746CB5 A59985A622B464A8 A27977F6B5E0677C E2C505E42D9F67D 3930DB7A6977A36B 24A10CC5C9592A9C 7AFB4E3ED45A0DE8 DC2F77630E1A44BF FC3417B7414148DF 552625731CAE0CA5 6793CA6F28C3B0AC C77E8EFACD4AA446 6C5805F9FCC11967 3CFFDE6F26064FBB B2EB0D73DAD9A828 1281BB9CCA3024B6 116985D08A09DA02 DBE29D9F27B7E060 CAC046C8432A07B1 308516132A2D62BA C165DBB0ADF58F53 C77E8EFACD4AA446 9472829ED5E5135 A59985A622B464A8 6B53D49885A7D707 8B79AB905B658256 5D719E5A0146C3A5 2FB017AF2F91A0A5 F915BB05F6DE8094 D24F04A616BC0A6E 48AB7067FA6A2D14 D24F04A616BC0A6E 2C52EC5B505F306A F06EDE60F71112ED 7846723773B6AF23 9C5107A4E9EE6FD7 92BDDAAAC0EEAC81 4C6A3D6ABAED1F40 53F05C97201AFB7C 4EE0210D1C792B08 958072C5DE54E3D9 621172AA03527836 672D3533F8C340E7 C410D29CA7472939 C2B922CB717E83C5 159F7B904A59A0A8 672D3533F8C340E7 E3F5C68EBB21C1F4 8D62F681E90CA80B DF1B6B7A6BCC8EF0 F568C9648CFC99C2 5FF018478D190A23 69CAA8E142F1518B 99AB658160CC88C0 8EFCEEA309192C36 A59985A622B464A8 D91739F32ACB6B83 69CAA8E142F1518B 372AD9743F4DE517 2AB6DC3A29B691C9 5137428DAC7B7AED 9A7A4D3599407BBB A760BB63D09C3D7 A5FCE99917A52581 FC3417B7414148DF C1EA8F8219F3324 1232171644AEE2D7 EF5550BAB4FC8DF7 BF4FBAEADD964624 7DD589ECF940D5C2 BA5B3C78D84BD884 F9933D34192BED57 530A2BF3634AC27F 99AB658160CC88C0 71FDB60FAD76B2E3 68CEF71DBDD509BD E8ABCE10CADA29F4 869890E64BAF686D 7A20FA862E09294A 75C8886A0FC0B3D6 50576890C420C606 BF0A9E59E62F7890 F915BB05F6DE8094 625808A1528282E4 2CA19703413D10D0 145C1DE7065B101D B80A48CDBFE8686 81A2047C7ED37C0C 1EAB305649C70751 8F63F5C2C5C0A878 A7A4315B687D116D F131F44F9DA46AFE 583F6252E1EA8915 5137428DAC7B7AED 142B8E2EC59DD9D7 20B8E8C0EBB67BC7 BF2A36303CF084AD FED8EA6F310C9ECA 2FB017AF2F91A0A5 1EEFE3EEAB65DC2A 7AA0A7DB845EC9D3 B7298881261E625E E3601411F669671A 166C9F888876ADFF 111112B2F100ABFC C08345E3F9E26C01 2D84FBDA147907DF B1A78583489FEA61 BBEEE51B09649C87 1BC9D1CD7A4C3DD8 CF40B446F0B00855 FA19A13472E6AEB4 7E6053B55C681C35 2C5C6C5E8F1C811F 967AF9E9FFB6C5BB 65C9194989094723 606D77F51A8A9DE1 4C6A3D6ABAED1F40 69CAA8E142F1518B 9EC84381BFBA2F17 1281BB9CCA3024B6 145C1DE7065B101D 8B454A83AD6D98CF 364988373067F9E C850224703BEA25C 60F900E1775A8335 CF830EDD4C31E0A5 958072C5DE54E3D9 87FD3D5D0D2E271 5137428DAC7B7AED 9CA11DD9BF207A98 1478575728FF3C0C 38FE42E8FF472784 46ABE2B8D69E43C7
#когда андрей болконский едет в имение отрадное, он видит старый дуб. встреча андрея болконского и дуба происходит в тяжелые моменты жизни главного героя, разочаровавшись в наполеоне, в войне и в себе самом, он не видит смысла своего существования. князь андрей видел перед собой огромный, в два обхвата, дуб. однако суки и кора его были обломаны, потому что дерево было довольно старым. на коре были старые болячки. дуб стоял на краю дороги, что подчеркивает его одиночество. он один был старым, сердитым и презрительным уродом среди улыбающихся берез. несмотря на то что под дубом были цветы и трава, он все равно стоял хмурясь, неподвижно, уродливо и упорно. только дуб, который видел андрей болконский, не хотел подчиняться обаянию весны. он не видел ни эту весну, ни солнце. дуб будто бы говорил, что все это глупый бессмысленный обман и что он не верит этим надеждам и обманам. однако при следующей встрече князя андрея с этим же дубом он был без корявых пальцев и без болячек. наоборот, через кору пробивались сочные молодые листья. в нем не было видно старого горя и недоверия.зр